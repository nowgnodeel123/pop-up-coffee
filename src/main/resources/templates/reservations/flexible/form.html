<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>FLIP COFFEE</title>
    <link rel="stylesheet" th:href="@{/css/flexible.css}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script type="text/javascript" th:inline="javascript">
        let dateInfos = $.parseJSON('[[ ${dateInfos} ]]');
    </script>
    <script type="text/javascript"  th:src="@{/script/flexCommon.js}"></script>
</head>
<body>
<header class="header">
    <nav class ="nav">
        <div class="container">
            <a href="/home" class ="left">FLIP COFFEE</a>
            <div class ="center">
                <a href="/about" class ="menu">ABOUT</a>
                <a href="/menu" class ="menu">MENU</a>
                <a th:href="@{/reservations/fixed/form}" class ="menu">STORE</a>
                <a href="/community" class ="menu">COMMUNITY</a>
                <a href="/admin" class ="menu">MANAGER</a>

            </div>
            <div class ="right">
                <a th:href="@{/merchants/login}" class ="login">로그인</a>
                <a href="" class ="mypage">마이페이지</a>
            </div>
            <div>
                <!--다음 등급 까지 ???점 남았습니다 표시-->
            </div>
        </div>
    </nav>
</header>
<main class="main">
    <div class="sidebar">
        <ul>
            <li><a href="#" class="big">ABOUT US</a></li>
            <li><a href="#" class="small">FLIP COFFEE IS</a></li>
            <li><a href="#" class="small">BI</a></li>
            <li><a href="#" class="small">오시는 길</a></li>
            <li><a href="#" class="big">Menu</a></li>
            <li><a href="#" class="small">NEW</a></li>
            <li><a href="#" class="small">COFFEE</a></li>
            <li><a href="#" class="small">CLOD BREW</a></li>
            <li><a href="#" class="small">BEVERAGE</a></li>
            <li><a href="#" class="small">FRAPRE</a></li>
            <li><a href="#" class="small">ADE & MOJITO</a></li>
            <li><a href="#" class="small">TEA & JUICE</a></li>
            <li><a href="#" class="small">DESSSERT</a></li>
            <li><a th:href="@{/reservations/fixed/form}" class="big">STORE</a></li>
            <li><a th:href="@{/reservations/fixed/form}" class="small">확정예약</a></li>
            <li><a th:href="@{/reservations/flexible/form}" class="small">유동예약</a></li>
            <li><a href="#" class="small">신청 조회</a></li>
            <li><a href="#" class="big">COMMUNITY</a></li>
            <li><a href="#" class="small">공지 사항</a></li>
            <li><a href="#" class="small">자주하는 질문</a></li>
            <li><a href="#" class="small">고객 상담</a></li>
            <li><a href="#" class="small">설문 조사</a></li>
            <!-- 관리자가 로그인할 경우 생기는 부분-->
            <li><a th:href="@{/menu/manage}" class="big">관리자</a></li>
            <li><a th:href="@{/spaces/assignment}" class="small">공간 관리</a></li>
            <li><a href="#" class="small">정책 관리</a></li>
            <li><a href="#" class="small">경고 관리</a></li>
            <li><a href="#" class="small">업체 관리</a></li>
            <li><a href="#" class="small">성수기 지정</a></li>
            <li><a th:href="@{/surveys/1/pie-chart}" class="small">통계 관리</a></li>
            <li><a href="#" class="small">정산 관리</a></li>
            <li><a href="#" class="small">이의 신청 관리</a></li>
            <li><a th:href="@{/surveys/setting}" class="small">설문 관리</a></li>
        </ul>
    </div>
    <div class="fix">
        <div style="display: grid; place-items: center; height: 10px">
            <h3>유동 예약</h3><br>
            <span th:text="${'유동 예약은 기존 대여료에서 ' + flexibleDiscountPercentage + '% 할인된 가격에 제공됩니다.'}"></span>
        </div>
        <div class="calendar-wrap">
            <div class="calendar-middle-wrap">
                <div class="cal_nav">
                    <a href="javascript:" class="nav-btn go-prev"></a>
                    <span class="year-month start-year-month"></span>
                    <a href="javascript:" class="nav-btn go-next"></a>
                </div>
                <div class="cal_wrap">
                    <div class="days">
                        <div class="day">일</div>
                        <div class="day">월</div>
                        <div class="day">화</div>
                        <div class="day">수</div>
                        <div class="day">목</div>
                        <div class="day">금</div>
                        <div class="day">토</div>
                    </div>
                    <div class="dates start-calendar"></div>
                </div>
            </div>

            <div class="calendar-middle-wrap">
                <div class="cal_nav">
                    <a href="javascript:" class="nav-btn go-prev"></a>
                    <span class="year-month last-year-month"></span>
                    <a href="javascript:" class="nav-btn go-next"></a>
                </div>
                <div class="cal_wrap">
                    <div class="days">
                        <div class="day">일</div>
                        <div class="day">월</div>
                        <div class="day">화</div>
                        <div class="day">수</div>
                        <div class="day">목</div>
                        <div class="day">금</div>
                        <div class="day">토</div>
                    </div>
                    <div class="dates last-calendar"></div>
                </div>
            </div>

            <div class="checkInOutInfo">
                <div>
                    <p>
                        <span>대여 가능 시작일</span>
                        <label id="check_in_day"></label>
                    </p>
                    <p class="space">~</p>
                    <p>
                        <span>대여 가능 종료일</span>
                        <label id="check_out_day"></label>
                    </p>

                    <span>현재 매출 수수료</span>
                    <label th:text="${gradeInfo.revenueSharingPercentage + '%'}"></label><br>
                    <span style="color: gray; font-size: 10pt">다음 등급의 매출 수수료</span>
                    <label style="color: gray; font-size: 10pt" th:text="${gradeInfo.nextGradeRevenueSharingPercentage + '%'}"></label><br>
                </div>
            </div>
        </div>
        <div>
            <form th:action="@{/reservations/flexible}" method="post">
                <div class="oneLine">
                    <div class="option">
                <select name="businessTypeId" class="selectBox" style="width: 200px">
                    <option>업종 선택</option>
                    <option th:each="businessType : ${businessTypes}" th:value="${businessType.id}" th:text="${businessType.name}"></option>
                </select>
                    </div>
                <input type="hidden" id="hidden_check_in_day" name="availabilityStartDate">
                <input type="hidden" id="hidden_check_out_day" name="availabilityEndDate">
                    <input type="hidden" id="hidden_dates" name="desiredDates">
                    <div class="dead">
                <span> 데드라인  </span>
                    <input type="date" id="deadline" name="deadline"><br>
                    </div>
                    <div class="dead">
                        <span> 대여기간  </span>
                        <input type="number" id="durations" name="duration"><br>
                    </div>
                </div>
                <span>필수 포함 날짜:</span>
                <div id="items">
                    <div class="item">
                        <label for="date">날짜</label>
                        <input type="date" id="date" name="desiredDates[0]">
                    </div>
                </div>
                <button type="button" id="addItem">날짜 추가</button>
                <input type="submit" value="예약하기">
            </form>

            <script>
                document.getElementById('addItem').addEventListener('click', function() {
                    const itemsDiv = document.getElementById('items');
                    const newItem = document.querySelector('.item').cloneNode(true);
                    const index = itemsDiv.children.length;

                    newItem.querySelectorAll('select, input').forEach(input => {
                        input.name = input.name.replace(/\[\d+]/, '[' + index + ']');
                        input.id = input.name;
                        input.value = '';
                    });

                    newItem.querySelectorAll('label').forEach(label => {
                        label.setAttribute('for', label.htmlFor.replace(/\d+/, index));
                    });

                    itemsDiv.appendChild(newItem);
                });

                document.querySelector('form').addEventListener('submit', function(e) {
                    document.getElementById('hidden_check_in_day').value = document.getElementById('check_in_day').textContent;
                    document.getElementById('hidden_check_out_day').value = document.getElementById('check_out_day').textContent;
                });
            </script>
        </div>
    </div>
</main>
<footer>
    <div class="footer-container">
        <div class="footer-group">
            <div class="footer-section">
                <div class='company-info'>
                    <h3>FLIP COFFEE</h3>
                    <p >(주)DB컴퍼니 | 대표자 : DB8조</p>
                    <p>부산광역시 해운대구 달맞이길 35</p>
                    <p>사업자등록번호 : 509-82-01524</p>
                    <p>대표번호 : 1811-5821 | FAX : 02-432-1421</p>
                    <P>________________________________________</P>
                    <P>2023 플립커피 All rights reserved.</P>
                </div>
                <div class="footer-links">
                    <p href="#">이용약관</p>
                    <p href="#">개인정보처리방침</p>
                </div>
            </div>
        </div>
    </div>
</footer>
</body>
</html>
